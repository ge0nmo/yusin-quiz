<!DOCTYPE html>
<html lang="ko" xmlns:th="https://www.thymeleaf.org/">
<head>
    <meta charset="UTF-8">
    <title>문제 관리</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-lite.min.css" rel="stylesheet">
    <link href="/static/css/problem.css" rel="stylesheet">
</head>
<body class="bg-light">

<div id="wrapper">
    <div th:replace="~{fragments/side.html :: side}"></div>
    <div id="content-wrapper">
        <header th:replace="~{fragments/header.html :: header}"></header>

        <div class="container-fluid px-4 py-4">
            <div class="card shadow-sm mb-4 border-0">
                <div class="card-body py-3">
                    <div class="row g-2 align-items-center">
                        <div class="col-lg-8 d-flex gap-2">
                            <div class="dropdown">
                                <button class="btn btn-outline-secondary dropdown-toggle" type="button" id="subject-dropdown" data-bs-toggle="dropdown">
                                    과목 선택
                                </button>
                                <ul class="dropdown-menu" id="subject-dropdown-content" style="max-height: 300px; overflow-y: auto;"></ul>
                            </div>
                            <div class="dropdown">
                                <button class="btn btn-outline-secondary dropdown-toggle" type="button" id="year-dropdown" data-bs-toggle="dropdown">
                                    연도 선택
                                </button>
                                <ul class="dropdown-menu" id="year-content"></ul>
                            </div>
                            <select id="examList" class="form-select" style="max-width: 250px;">
                                <option value="">시험을 선택하세요</option>
                            </select>
                            <button class="btn btn-primary search-click px-4">
                                <i class="fas fa-search me-1"></i> 조회
                            </button>
                        </div>
                        <div class="col-lg-4 text-end">
                            <button class="btn btn-success text-white fw-bold shadow-sm add-problem-button" data-bs-toggle="modal" data-bs-target="#add-problem-modal">
                                <i class="fas fa-plus me-1"></i> 새 문제 등록
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="examTable" class="problems-container">
                <div class="text-center py-5 text-muted w-100">
                    <i class="fas fa-search fa-3x mb-3 text-gray-300"></i>
                    <p>과목과 시험을 선택하여 문제를 조회하세요.</p>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="add-problem-modal" tabindex="-1" data-bs-backdrop="static">
    <div class="modal-dialog modal-dialog-centered modal-xl modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header bg-white border-bottom-0 pb-0">
                <h5 class="modal-title fw-bold text-primary">
                    <i class="fas fa-edit me-2"></i><span id="modalTitle">문제 등록</span>
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>

            <div class="modal-body bg-light">
                <div class="card border-0 shadow-sm mb-3">
                    <div class="card-body py-2">
                        <div class="row g-3 text-secondary small">
                            <div class="col-md-4"><label class="fw-bold me-2">과목:</label><input id="subjectTitle" type="text" class="border-0 bg-transparent fw-bold text-dark" disabled></div>
                            <div class="col-md-4"><label class="fw-bold me-2">시험:</label><input id="examName" type="text" class="border-0 bg-transparent fw-bold text-dark" disabled></div>
                            <div class="col-md-4"><label class="fw-bold me-2">연도:</label><input id="examYear" type="text" class="border-0 bg-transparent fw-bold text-dark" disabled></div>
                        </div>
                    </div>
                </div>

                <div class="card shadow-sm border-0 mb-3">
                    <div class="card-header bg-white fw-bold text-dark d-flex align-items-center justify-content-between">
                        <span><i class="fas fa-question-circle me-1"></i> 문제 정보</span>
                        <div class="d-flex align-items-center">
                            <label class="me-2 small text-muted">No.</label>
                            <input id="problemNumber" type="number" class="form-control form-control-sm text-center fw-bold text-primary" style="width: 80px;" placeholder="번호">
                        </div>
                    </div>
                    <div class="card-body p-0">
                        <textarea id="problemContent"></textarea>
                    </div>
                </div>

                <div class="row g-3">
                    <div class="col-lg-6">
                        <div class="card shadow-sm border-0 h-100">
                            <div class="card-header bg-white fw-bold text-success d-flex justify-content-between align-items-center">
                                <span><i class="fas fa-list-ol me-1"></i> 보기 설정</span>
                                <button type="button" class="btn btn-sm btn-outline-success" id="addChoiceBtn">
                                    <i class="fas fa-plus"></i> 추가
                                </button>
                            </div>
                            <div class="card-body bg-light">
                                <div class="alert alert-light border small text-muted py-2 mb-2">
                                    <i class="fas fa-info-circle me-1"></i> 왼쪽 라디오 버튼을 선택하여 정답을 지정하세요.
                                </div>
                                <div id="choicesContainer"></div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-6">
                        <div class="card shadow-sm border-0 h-100">
                            <div class="card-header bg-white fw-bold text-secondary">
                                <i class="fas fa-comment-alt me-1"></i> 문제 해설
                            </div>
                            <div class="card-body p-0">
                                <textarea id="problemExplanation"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-footer bg-white border-top-0 pt-0">
                <button type="button" class="btn btn-light" data-bs-dismiss="modal">취소</button>
                <button type="button" class="btn btn-primary px-4 problem-save-button">
                    <i class="fas fa-save me-2"></i> 저장 완료
                </button>
            </div>
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-lite.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/lang/summernote-ko-KR.min.js"></script>
<script src="/static/js/problem.js"></script>
</body>
</html>